\documentclass[a4paper,12pt,oneside,openany,table,xcdraw]{article}

\usepackage{setspace}
\usepackage{multirow}
\usepackage{hyperref}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{tikz} %% fasores
\usetikzlibrary{arrows,arrows.meta,quotes,angles}
\usepackage{siunitx}

\usepackage[brazilian]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath, graphicx, subfig, enumerate}
\usepackage{float, verbatim}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{makeidx}
\usepackage{geometry}

\graphicspath{{img/}}
\geometry{a4paper, hmargin={3cm, 3cm}, vmargin={3cm, 2cm} }
\setlength{\parindent}{1.0cm}
\captionsetup{font=small}

\usepackage{mathtools,listings} %%
\usepackage{color} %red, green, blue, yellow, cyan, magenta, black, white
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}
\usepackage{listingsutf8}

\begin{document}
\newcommand{\thedepartment}{Faculdade de Engenharia Elétrica}
\newcommand{\thecourse}{FEELT}
\newcommand{\thetitle}{Resolução da Lista de Exercícios Extras}
\newcommand{\thetype}{Trabalho de Sinais e Sistemas II}
\newcommand{\theproftitle}{Bacharel em Engenharia Elétrica}
\newcommand{\thestudent}{Lesly Viviane Montúfar Berrios\\
\centering11811ETE001}
\newcommand{\theadvisor}{Prof. Wellington Maycon Santos Bernardes}
\newcommand{\thecity}{Uberlândia}

\thispagestyle{empty}\input{CapaABNT}

\lstset{language=Matlab,%
	inputencoding=utf8/latin1,
    %basicstyle=\color{red},
    breaklines=true,%
    morekeywords={matlab2tikz},
    keywordstyle=\color{blue},%
    morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},
    identifierstyle=\color{black},%
    stringstyle=\color{mylilas},
    commentstyle=\color{mygreen},%
    showstringspaces=false,%without this there will be a symbol in the places where there is a space
    numbers=left,%
    numberstyle={\tiny \color{black}},% size of the numbers
    numbersep=9pt, % this defines how far the numbers are from the text
    emph=[1]{for,end,break},emphstyle=[1]\color{red}, %some words to emphasise
    %emph=[2]{word1,word2}, emphstyle=[2]{style},    
}

%% Comeca o documento !

\onehalfspacing
\tableofcontents % sumário
\newpage

\section{Exercício 1}
 Por meio do código em anexo (Anexo \ref{anexo:ex1}) foi possível as informações retirar informações dispostas nas subssões seguintes.
\vspace{0.3cm}

% \lstinputlisting{EX1/EX1.m}

\vspace{0.3cm}
\subsection{Determinação de polos e zeros e curva de resposta em frequência}
Pede-se modelar um filtro seletivo para uma determinada frequência $f_rejeitada$, da qual se extrairá os polos e zeros necessários. Para isso, é necessário relacionar a frequência a ser retirada com a frequência de amostragem $F_S$ por meio de $w_{rejeitada} = 2*pi*freq_{rejeitada}/F_s$, da qual se retira os os zeros $0.5877 - 0.8089i$ e $0.5877 + 0.8089i$, e polos $0.0823 - 0.2427i$,  $0.0823 + 0.2427i$,  $0.3703 - 0.6067i$ e $0.3703 + 0.6067i$. Na Figura \ref{ex1:polos} tem-se o diagrama de polos correspondente do filtro projetado.

\vspace{0.6cm}
\begin{figure}[H]
\centering
\includegraphics[width=13.5cm]{ex1-pz}
\caption{Diagramas de polos e zeros do filtro seletivo.}
\label{ex1:polos}
\end{figure}
\vspace{0.4cm}

A partir dos polos e zeros é possível plotar a curva da resposta em frequência, como na Figura \ref{ex1:H}. Dela vê-se que tem-se o propósito de atenuar a frequência digital de $\dfrac{3 \pi}{10}$.
\vspace{0.4cm}

\begin{figure}[H]
\centering
\includegraphics[width=13cm]{ex1-h}
\caption{Resposta em frequência do filtro seletivo.}
\label{ex1:H}
\end{figure}
\vspace{0.1cm}

\subsection{Equação de diferenças e taxa de aquisição}
Considerando uma taxa e aquisição de $F_S=20kHz$ de acordo com o Teorema de Nyquist, pois deve-se ter pelo menos $F_S<2*f_{max}$ para reduzir a distorção significante provocada pelo aliasing. Além disso, a partir dos polos e zeros projetados para eliminar certa frequência, é possível escrever a equação de diferenças correspondente. \\
Com b:
$$0\quad   0\quad   0.0364\quad -0.0427\quad 0.0364$$
e a:
$$1\quad -0.9051\quad 0.6927\quad -0.1318\quad 0.0332$$

\vspace{0.3cm}
\subsection{Comparação entre sinal de entrada e saída}
Aplicando-se a equação de diferenças, ilustrada na Figura \ref{ex1:H}, ao sinal de entrada $x(t)$, tem-se no domínio da frequência a comparação mostrada na Figura \ref{ex1:comp:H} e, após a aplicar a transformar a Transformada Inversa de Fourier para converter novamente para o domínio do tempo, tem-se a comparação vista na Figura \ref{ex1:comp:t}.


\begin{figure}[H]
\centering
\includegraphics[width=15cm]{ex1-comp-H}
\caption{Compração entrada vs. saída no domínio da frequência.}
\label{ex1:comp:H}
\end{figure}
\vspace{0.1cm}

\begin{figure}[H]
\centering
\includegraphics[width=15cm]{ex1-comp-t}
\caption{Compração entrada vs. saída no domínio do tempo.}
\label{ex1:comp:t}
\end{figure}
\vspace{0.1cm}

\subsection{Obtenção de saída y(t) por laço for}
A partir dos polos e zeros e zeros determinados tem-se a função de transferência, descrita pela Equação (\ref{ex1:H:pz}). Escolheu-se mais polos que zeros para garantir a estabilidade do sistema.

\begin{equation} \label{ex1:H:pz}
H(z) = 0.0364\  \dfrac{ (z - (0.5877 \pm 0.8089i) )}{(z - (0.0823 \pm 0.2427i))\ (z - (0.3703 \pm 0.6067i))}
\end{equation}
\vspace{0.1cm}

Simplificando \ref{ex1:H:pz} tem-se \ref{ex1:H:ab}, no qual visualizam-se os coeficientes $b$ e $a$.
\begin{equation} \label{ex1:H:ab}
H(z) = \dfrac{Y(z)}{X(z)}=\dfrac{0 - 0\ z^{-1} + 0.0364\ z^{-2} -0.0427\ z^{-3} + 0.0364\ z^{-4}}{1 -0.9051\ z^{-1} +0.6927\ z^{-2} -0.1318\ z^{-3} +0.0332\ z^{-4}}
\end{equation}
\vspace{0.2cm}

Assim, aplicando a transformada de Z inversa, tem-se a equação de diferenças em (\ref{ex1:eqdif}), da qual é possível determinar a saída, como realizado no código em anexo (Anexo \ref{anexo:ex1}) por meio do comando \textbf{\emph{for}}. Ademais, na Figura \ref{ex1:yn} observa-se o resultado obtido, sendo que para as extremidades as distorções levam $y[n]$ a 0 devido a consideração de que para $n<0$, $y[n]=0$.

\begin{multline} \label{ex1:eqdif}
y[n] = 0.9051\ y[n-1] - 0.6927 \ y[n-2]  +0.1318\ y[n-3]  - 0.0332\ y[n-4] \\
+ 0.0364\ x[n-2]   -0.0427\ x[n-3]  +  0.0364\ x[n-4]
\end{multline}

\vspace{0.2cm}
\begin{figure}[H]
\centering
\includegraphics[width=13cm]{ex1_yn}
\caption{Sinal y[n] obtida pela equação de diferenças.}
\label{ex1:yn}
\end{figure}


\vspace{0.5cm}
\section{Exercício 2}
Dada a equação de diferenças tem-se, na Equação (\ref{ex2:eqdif}), sua forma após aplicar-se a Transformada Z. Para assim obter a equação de sua resposta em frequência como na Equação (\ref{ex2:Hz}) e analisá-la no espectro da frequência como na Figura \ref{ex2:H}.

\begin{gather} 
y[n] - y[n-1] + \dfrac{1}{4} y[n-2] = x[n] +\dfrac{1}{4} x[n-1] -\dfrac{1}{8} x[n-2] \label{ex2:eqdif} \\
\\
Y(z)\ (1 - 1\ z^{-1} + 0.25\ z^{-2}) = X(z)\ (1 + 0.25\ z^{-1} + 0.125\ z^{-2})
\end{gather}

\begin{equation} \label{ex2:Hz}
H(z) = \dfrac{1 + 0.25\ z^{-1} + 0.125\ z^{-2}}{1 - 1\ z^{-1} + 0.25\ z^{-2}}
\end{equation}

\vspace{0.3cm}
\begin{figure}[H]
\centering
\includegraphics[width=13cm]{ex2-Hz}
\caption{Espectro em frequência da equação de diferenças.}
\label{ex2:H}
\end{figure}

\vspace{0.4cm}
\subsection{Estabilidade do sistema}
A resposta em frequênia do sistema tabém pode ser escrita como mostrado na Equação (\ref{ex2:pz}), na qual observa-se a posição dos polos e zeros. Como há mais polos que zeros a primeira condição para a estabilidade foi obedecida, além de que os polos estão contidos no círculo de raio unitário. Também verifica-se da Figura  \ref{ex2:H} a estabilidade do sistema, uma vez que entradas limitadas gerarão saídas limitas, que conforme com o critério de estabilidade BIBO.

\begin{equation} \label{ex2:pz}
H(z) = \dfrac{(z-(-0.1250 \pm 0.3307i))}{(z-0.5)\ (z-0.5)}
\end{equation}
 
\vspace{0.3cm}
\subsection{Resposta ao degrau}
A resposta degrau foi obtida pela equação de diferenças, a partir da Tranformada Z inversa de \ref{ex2:Hz} e observa-se na Figura \ref{ex2:u}.

\vspace{0.2cm}
\begin{figure}[H]
\centering
\includegraphics[width=15cm]{ex2-u}
\caption{Espectro em frequência e tempo da resposta ao degrau unitário.}
\label{ex2:u}
\end{figure}

\vspace{0.3cm}
\section{Exercício 3}
\subsection{Análise da função de transferência do motor}

\subsection{Redução de \emph{overshoot}}


\subsection{Aumento da velocidade do motor}



\newpage
\section{Anexos}
\subsection{Código correspondente ao exercício 1} \label{anexo:ex1}
\lstinputlisting{EX1/EX1.m}

\vspace{0.3cm}
\subsection{Código correspondente ao exercício 2} \label{anexo:ex2}
\lstinputlisting{EX2/EX2.m}

\vspace{0.3cm}
\subsection{Código correspondente ao exercício 3} \label{anexo:ex3}
\lstinputlisting{EX2/EX2.m}

\vspace{0.3cm}
\subsection{Código correspondente ao exercício 4} \label{anexo:ex4}
\lstinputlisting{EX2/EX2.m}

\newpage
\begin{thebibliography}{9} 
% Introdução
\bibitem{S1}
    ...,
    “Sistemas de Controle para a Engenharia”, Avaliação da Qualidade da Energia Elétrica, DSE – FEEC – UNICAMP , 2019.
 
\bibitem{S2}
    ...,
    “Sinais e Sistemas”,... , 2019.

\end{thebibliography}
\end{document}
